<div class="kt-portlet" [ngClass]="{ 'kt-portlet--body-progress kt-portlet--body-progress-overlay' : loading }">
   <div class="kt-portlet__head kt-portlet__head__custom">
      <div class="kt-portlet__head-label">
         <!-- <button mat-icon-button matTooltip="Voltar" [routerLink]="/vendas">
            <i class="fa fa-arrow-left"></i>
         </button> -->
         <h3 class="kt-portlet__head-title">Lista de Usuários</h3>
      </div>

      <div class="kt-portlet__head-toolbar">
         <button class="btn btn-sm btn-primary" (click)="open()" matTooltip="Cria um novo usuário"
            *ngIf="permissions.create_user">
            <i class="fas fa-user-plus"></i> Novo Usuário
         </button>
         <button class="btn btn-sm btn-primary" (click)="open_nivel()" matTooltip="Cria um novo nível"
            *ngIf="permissions.nivel_user">
            <i class="fas fa-lock"></i> Novo Nível
         </button>
         <button class="btn btn-sm btn-success" (click)="open_filters(filtros)" matTooltip="Filtra os dados">
            <i class="fas fa-sliders-h"></i> Filtros
         </button>
         <button class="btn btn-label-brand btn-bold btn-sm" (click)="load_list()" matTooltip="Atualiza a lista">
            <i class="fas fa-sync-alt" [class.fa-spin]="loading"></i>
         </button>
      </div>
   </div>
   <div class="kt-form kt-portlet__body">

      <div class="kt-portlet__body-progress">
         <mat-spinner [diameter]="40"></mat-spinner>
      </div>

      <div class="table-responsive">
         <table class="table  mb-0">
            <thead class="">
               <th width="10%">Código</th>
               <th width="30%">Nome</th>
               <th width="15%">Nível</th>
               <th width="10%">status</th>
               <th width="10%"></th>
            </thead>
         </table>
         <div [style.height.px]="screen">

            <div align="center" *ngIf="dataSource.length <= 0">
               <strong>Nenhum usuário encontrado!</strong>
            </div>

            <table class="table table-hover mb-0">
               <tbody>
                  <tr *ngFor="let item of dataSource">
                     <td width="10%">{{item.id}}</td>
                     <td width="30%">{{item.nome | titlecase}}</td>
                     <td width="15%">
                        {{ item.nivel }}
                        <button mat-icon-button color="primary" matTooltip="Editar" (click)="open_nivel(item)"
                           *ngIf="item.permissions > 0 && permissions.nivel_user">
                           <i class="fas fa-pen"></i>
                        </button>
                     </td>
                     <td width="10%">
                        <span class="badge badge-info" *ngIf="item.status == 1">Ativo</span>
                        <span class="badge badge-danger" *ngIf="item.status == 2">Inativo</span>
                     </td>


                     <td width="10%" class="text-right">
                        <button mat-icon-button color="primary" matTooltip="Editar" (click)="open(item)"
                           *ngIf="permissions.edit_user">
                           <i class="fas fa-pen"></i>
                        </button>
                        <button mat-icon-button color="warn" matTooltip="Deletar" (click)="delete_confirm(item)"
                           *ngIf="permissions.delete_user">
                           <i class="fas fa-trash"></i>
                        </button>
                     </td>

                  </tr>
               </tbody>
            </table>
         </div>

      </div>

   </div>
</div>


<ng-template #filtros let-modal>
   <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Filtros</h4>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
         <span aria-hidden="true">&times;</span>
      </button>
   </div>
   <div class="modal-body">
      <div class="row">
         <div class="col-sm-12">
            <span>Pesquisa:</span>
            <input type="text" class="form-control" [(ngModel)]="filters.termo">
         </div>
      </div>
   </div>
   <div class="modal-footer">
      <button type="button" class="btn btn-primary" (click)="modal.close('close click');load_list();">Confirmar</button>
   </div>
</ng-template>